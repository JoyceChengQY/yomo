# https://taskfile.dev

version: '3'

tasks:
  basic:
    desc: run basic example
    deps: [basic-zipper,basic-source,basic-flow]
    cmds:
      - echo 'basic example'

  basic-source:
    desc: run basic source example
    deps: [basic-source-build]
    dir: "example/basic/source"
    cmds:
      - "./source{{exeExt}}"
    env:
      YOMO_ENABLE_DEBUG: false

  basic-source-build:
    desc: build basic source example
    dir: "example/basic/source"
    cmds:
      - echo "basic source building..."
      - "go build -o source{{exeExt}} main.go"
      - echo "basic source built."
    silent: false

  basic-zipper:
    desc: run basic zipper service
    deps: [basic-zipper-build]
    dir: "example/basic/zipper"
    cmds:
      # - "yomo serve -v -c workflow.yaml"
      - "./zipper{{exeExt}}"
    env:
      YOMO_ENABLE_DEBUG: false
      YOMO_LOG_LEVEL: info

  basic-zipper-build:
    desc: build basic zipper example
    dir: "example/basic/zipper"
    cmds:
      - echo "basic zipper building..."
      - "go build -o zipper{{exeExt}} main.go"
      - echo "basic zipper built."
    silent: false

  basic-flow:
    desc: run basic flow stream function
    deps: [basic-flow-build]
    dir: "example/basic/flow"
    cmds:
      - "./flow{{exeExt}}"
    env:
      YOMO_ENABLE_DEBUG: false

  basic-flow-build:
    desc: build basic flow stream function
    dir: "example/basic/flow"
    cmds:
      - echo "basic flow building..."
      - "go build -o flow{{exeExt}} main.go"
      - echo "basic flow built."
    silent: false
